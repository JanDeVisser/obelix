include(FindPkgConfig)
pkg_search_module(PGSQL libpq)

IF ( NOT PGSQL_FOUND )
	IF ( PGSQL_INSTALL_DIR )
		MESSAGE ( STATUS "Using override PGSQL_INSTALL_DIR to find PGSQL" )
		SET ( PGSQL_INCLUDE_DIR  "${PGSQL_INSTALL_DIR}/include" )
		FIND_LIBRARY( PGSQL_LIBRARIES NAMES pq PATHS "${PGSQL_INSTALL_DIR}/lib" )
	ELSE ( PGSQL_INSTALL_DIR )
		FIND_PATH( PGSQL_INCLUDE_DIR libpq-fe.h )
		FIND_LIBRARY( PGSQL_LIBRARIES NAMES pq )
	ENDIF ( PGSQL_INSTALL_DIR )

	IF ( PGSQL_INCLUDE_DIR AND PGSQL_LIBRARIES )
		SET ( PGSQL_FOUND 1 )
		SET ( PGSQL_INCLUDE_DIRS "${PGSQL_INCLUDE_DIR}" )
	ENDIF ( PGSQL_INCLUDE_DIR AND PGSQL_LIBRARIES )
ENDIF( NOT PGSQL_FOUND )

if(PGSQL_FOUND)
  message(STATUS "Found PGSQL: -L ${PGSQL_LIBRARIES} -I ${PGSQL_INCLUDE_DIRS}")
else(PGSQL_FOUND)
  if(PGSQL_FIND_REQUIRED)
    message(FATAL_ERROR "Could NOT find PGSQL" )
  else(PGSQL_FIND_REQUIRED)
    message(STATUS "Could NOT find PGSQL")
  endif(PGSQL_FIND_REQUIRED)
endif(PGSQL_FOUND)

# Hide advanced variables from CMake GUIs
MARK_AS_ADVANCED( PGSQL_INCLUDE_DIR PGSQL_INCLUDE_DIRS PGSQL_LIBRARIES )
