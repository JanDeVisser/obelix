include(FindPkgConfig)
pkg_search_module(PGSQL libpq)

IF ( NOT PGSQL_FOUND )
	IF ( PGSQL_INSTALL_DIR )
		MESSAGE ( STATUS "Using override PGSQL_INSTALL_DIR to find PGSQL" )
		SET ( PGSQL_INCLUDE_DIR  "${PGSQL_INSTALL_DIR}/include" )
		FIND_LIBRARY( PGSQL_LIBRARY NAMES PGSQL PATHS "${PGSQL_INSTALL_DIR}/lib" )
	ELSE ( PGSQL_INSTALL_DIR )
		FIND_PATH( PGSQL_INCLUDE_DIR libpq-fe.h )
		FIND_LIBRARY( PGSQL_LIBRARIES NAMES pq )
	ENDIF ( PGSQL_INSTALL_DIR )

	IF ( PGSQL_INCLUDE_DIR AND PGSQL_LIBRARIES )
		SET( PGSQL_FOUND 1 )
    SET ( PGSQL_INCLUDE_DIRS "${PGSQL_INCLUDE_DIR}" )
		IF ( NOT PGSQL_FIND_QUIETLY )
			MESSAGE ( STATUS "Found PGSQL: ${PGSQL_LIBRARIES}" )
		ENDIF ( NOT PGSQL_FIND_QUIETLY )
	ELSE ( PGSQL_INCLUDE_DIR AND PGSQL_LIBRARIES )
		IF ( PGSQL_FIND_REQUIRED )
			MESSAGE( FATAL_ERROR "Could NOT find PGSQL" )
		ELSE ( PGSQL_FIND_REQUIRED )
			IF ( NOT PGSQL_FIND_QUIETLY )
				MESSAGE( STATUS "Could NOT find PGSQL" )
			ENDIF ( NOT PGSQL_FIND_QUIETLY )
		ENDIF ( PGSQL_FIND_REQUIRED )
	ENDIF ( PGSQL_INCLUDE_DIR AND PGSQL_LIBRARIES )
ENDIF( NOT PGSQL_FOUND )
MESSAGE ( STATUS "Found PGSQL: -L ${PGSQL_LIBRARIES} -I ${PGSQL_INCLUDE_DIRS}" )

# Hide advanced variables from CMake GUIs
MARK_AS_ADVANCED( PGSQL_INCLUDE_DIR PGSQL_LIBRARIES )
